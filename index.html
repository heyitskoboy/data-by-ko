<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Valentine Bloom</title>
<style>
body{
    margin:0;
    overflow:hidden;
    background:#f5efe6;
    font-family:monospace;
}

canvas{ display:block; }

#message{
    position:fixed;
    bottom:30px;
    width:100%;
    text-align:center;
    font-size:20px;
    color:#7a5c58;
    opacity:0;
    transition:opacity 2s;
}

#tap{
    position:fixed;
    top:45%;
    width:100%;
    text-align:center;
    font-size:24px;
    color:#a67c6d;
}

#countdown{
    position:fixed;
    top:52%;
    width:100%;
    text-align:center;
    font-size:60px;
    color:#c08497;
    font-weight:bold;
}
</style>
</head>
<body>

<div id="tap">Get ready... ðŸŒ¸</div>
<div id="countdown">5</div>
<div id="message"></div>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const codeChars = "<>/*{}()#=+LoveForever2026*/";

const wishes = [
"Happy Valentine's Day ðŸ’–",
"May your heart always bloom ðŸŒ¸",
"Love grows gently ðŸ’•",
"You are someone's miracle ðŸ’ž",
"Let love blossom forever ðŸŒ·",
"May your days be soft and warm ðŸŒ¼",
"Love shines quietly within you ðŸŒº"
];

document.getElementById("message").innerText =
wishes[Math.floor(Math.random()*wishes.length)];

let letters = [];
let targets = [];
let state = "rain"; // rain â†’ clear â†’ wait â†’ bloom

class Letter{
    constructor(x,y,color){
        this.x = x;
        this.y = y;
        this.tx = null;
        this.ty = null;
        this.color = color;
        this.char = codeChars[Math.floor(Math.random()*codeChars.length)];
        this.fallSpeed = 2 + Math.random()*3;
        this.clearSpeed = 8 + Math.random()*5;
    }

    update(){
        if(state==="rain"){
            this.y += this.fallSpeed;
        }
        else if(state==="clear"){
            this.y += this.clearSpeed;
        }
        else if(state==="bloom"){
            if(this.tx!==null){
                this.x += (this.tx - this.x)*0.03;
                this.y += (this.ty - this.y)*0.03;
            }
        }
    }

    draw(){
        ctx.fillStyle=this.color;
        ctx.fillText(this.char,this.x,this.y);
    }
}

function randomSoftColor(){
    const colors=[
        "#e8a0bf","#f4b6c2","#f7c8a4",
        "#f2a7a7","#d8a7b1","#c08497",
        "#b8c0ff","#ffc8dd"
    ];
    return colors[Math.floor(Math.random()*colors.length)];
}

/* ðŸŒ¸ CREATE UNIQUE FLOWERS */
function createTargets(){
    const centerX = canvas.width/2;
    const baseY = canvas.height*0.8;
    const flowerCount = 4;
    targets = [];

    const patterns = [
        t => Math.sin(4*t),
        t => 1+0.4*Math.sin(6*t),
        t => 1-Math.sin(t),
        t => t/(Math.PI*2),
        t => Math.cos(3*t),
        t => 1+0.3*Math.cos(5*t),
        t => Math.abs(Math.sin(2*t)),
        t => 0.8+0.2*Math.sin(10*t),
        t => Math.sin(5*t)*Math.cos(2*t),
        t => 1+0.5*Math.sin(3*t)*Math.cos(3*t),
        t => Math.abs(Math.cos(4*t)),
        t => 1+0.3*Math.sin(8*t)
    ];

    patterns.sort(()=>Math.random()-0.5);

    for(let f=0; f<flowerCount; f++){

        const offsetX = (f-1.5)*180;
        const size = 70 + Math.random()*40;
        const formula = patterns[f];

        // Stem
        for(let y=0;y<140;y+=5){
            targets.push({
                x:centerX+offsetX,
                y:baseY-y,
                color:"#5b8c5a"
            });
        }

        // Leaves
        for(let t=0;t<Math.PI;t+=0.2){
            targets.push({
                x:centerX+offsetX + 45*Math.cos(t),
                y:baseY-70 + 25*Math.sin(t),
                color:"#6aa84f"
            });
            targets.push({
                x:centerX+offsetX - 45*Math.cos(t),
                y:baseY-70 + 25*Math.sin(t),
                color:"#6aa84f"
            });
        }

        // Petals (unique)
        for(let t=0;t<Math.PI*2;t+=0.1){
            let r = size * formula(t);

            targets.push({
                x:centerX+offsetX + r*Math.cos(t),
                y:baseY-160 + r*Math.sin(t),
                color:randomSoftColor()
            });
        }
    }

    letters=[];
    targets.forEach(p=>{
        let l=new Letter(Math.random()*canvas.width,-20,p.color);
        l.tx=p.x;
        l.ty=p.y;
        letters.push(l);
    });
}

/* ðŸŽ¬ ANIMATION LOOP */
function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.font="16px monospace";

    letters.forEach(l=>l.update());
    letters = letters.filter(l=>l.y < canvas.height+50);

    letters.forEach(l=>l.draw());

    if(state==="clear" && letters.length===0){
        state="wait";
        document.getElementById("tap").innerText="Now tap to let the flowers bloom ðŸŒ¸";
    }

    requestAnimationFrame(animate);
}

animate();

/* ðŸŒ§ CODE RAIN */
let rainInterval = setInterval(()=>{
    if(state==="rain"){
        for(let i=0;i<25;i++){
            letters.push(
                new Letter(
                    Math.random()*canvas.width,
                    -20,
                    randomSoftColor()
                )
            );
        }
    }
},100);

/* â³ COUNTDOWN */
let timeLeft = 5;
const countdownEl = document.getElementById("countdown");

let timer = setInterval(()=>{
    timeLeft--;
    countdownEl.innerText = timeLeft;

    if(timeLeft<=0){
        clearInterval(timer);
        clearInterval(rainInterval);
        countdownEl.style.display="none";
        state="clear";
    }
},1000);

/* ðŸ‘† CLICK TO BLOOM */
document.body.addEventListener("click",()=>{
    if(state==="wait"){
        state="bloom";
        document.getElementById("tap").style.display="none";
        document.getElementById("message").style.opacity=1;
        createTargets();
    }
});
</script>

</body>
</html>
